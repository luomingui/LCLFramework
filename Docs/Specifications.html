<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>Specifications-LCL框架文档</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="css/lcl.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="navheader">
        <table width="100%" summary="Navigation header">
            <tr>
                <th colspan="3" align="center" style="text-align: center;">Specifications</th>
            </tr>
            <tr>
                <td width="20%" align="left">
                    <a accesskey="p" href="Domain-Services.html">Prev</a>&nbsp;
                </td>
                <th width="60%" align="center">&nbsp;</th>
                <td width="20%" align="right">
                    &nbsp;
                    <a accesskey="n" href="Unit-Of-Work.html">Next</a>
                </td>
            </tr>
        </table><hr />
    </div>

    <div class="document-contents">
        <h3>规约模式（Specifications）</h3>
        <p>
            <strong><em>规范模式</em></strong><em>
                是一种特定的软件设计模式，通过使用布尔逻辑(<a href="https://en.wikipedia.org/wiki/Specification_pattern" target="_blank">Wikipedia</a>)将业务规则链接在一起，可以将业务规则重新组合起来。<br />
            </em>
        </p>
        <p>在实践中，它主要用于为实体或其他业务对象定义<strong>可重用的过滤器</strong>。</p>
        <h4>示例</h4>
        <pre lang="cs">
    public class KeyRoleSpecification : Specification&lt;Role&gt;
    {
        string _keyword = "";
        string _fieldName = "";
        public KeyRoleSpecification(string keyword, string fieldName)
        {
            _keyword = keyword;
            _fieldName = fieldName;
        }
        public override Expression&lt;func&lt;Role&gt;, bool=bool&gt;&gt; GetExpression()
        {
            Expression&lt;func&lt;Role, bool=bool&gt;&gt; spec = null;
            switch (_fieldName)
            {
                case "Name":
                    spec = c => c.Name.IndexOf(_keyword) != -1;
                    break;
            }
            return spec;
        }
    }
</pre>

        <blockquote>
            <h4 id="提示getcache方法">提示：Linq模糊查询</h4>
            <p>
                n.Name.StartsWith(Name)－－相当于A%<br />
                n.Name.EndsWith(Name)  －－相当于%A<br />
                n.Name.IndexOf(Name)!=-1 --相当于%A%<br />
                var listWhere = list.Where(n=>n.Name.StartsWith(Name)||
                n.Name.EndsWith(Name)||<br />
                n.Name.IndexOf(Name)!=-1);<br />
                或<br />
                var listWhere = list.Where(n=>n.Name.Contains(Name));<br />
            </p>
        </blockquote>

        <pre lang="cs">
 public partial class RoleService : IRoleService
    {
        private readonly IRepository&lt;role&gt; _roleRepository;
        private readonly ICacheManager _cacheManager;
        public RoleService(ICacheManager cacheManager, IRepository&lt;Role&gt; roleRepository)
        {
            this._cacheManager = cacheManager;
            this._roleRepository = roleRepository;
        }
        public int GetRoleCount(ISpecification&lt;Role&gt; spec)
        {
            var roles = _roleRepository.FindAll();
            var roleCount = 0;
            foreach (var role in roles)
            {
                if (spec.IsSatisfiedBy(role))
                {
                    roleCount++;
                }
            }
            return roleCount;
        }
    }
</pre>


        <p>
            因此，我们可以将任何对象作为实现<strong>ISpecification&lt;Role&gt;</strong> 规约的接口的参数，该接口定义如下所示:
        </p>
        <pre lang="cs">public interface ISpecification&lt;T&gt;
{
        <strong>bool IsSatisfiedBy(T obj);</strong>
}</pre>


    </div>

    <div class="navfooter">
        <hr /><table width="100%" summary="Navigation footer">
            <tr>
                <td width="40%" align="left"><a accesskey="p" href="Domain-Services.html">Prev</a>&nbsp;</td>
                <td width="20%" align="center"><a accesskey="h" href="index.html">Home</a>&nbsp;</td>
                <td width="40%" align="right"><a accesskey="n" href="Unit-Of-Work.html">Next</a>&nbsp;</td>
            </tr>
        </table>
    </div>


</body>
</html>
